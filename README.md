# kube-ahoy
Kube Ahoy! Easily manage your kubeconfig for a whole fleet of Kubernetes clusters.

### A "plethora" of contexts
I wrote this utility because each time I added a new cluster to my kubeconfig, I found that keeping everything in my kubeconfig straight got a little harder. In particular, I found that OpenShift clusters caused my kubeconfig to practically explode with contexts. kube-ahoy provides an easy, interactive menu to help you switch contexts by choosing a cluster, user, and namespace.

```
# Get useful details about the current context
./kube-ahoy.py

# See usage parameter details and examples
./kube-ahoy.py --help

# Change to a different context, via a sweet full-screen menu
./kube-ahoy.py --context
```

### Clean namespace switching
To complicate matters further, different CLI tools take different approaches to changing namespaces. In particular, OpenShift's *oc* creates a separate context for each namespace. kube-ahoy has a namespace switching function that determines whether your current context is for OpenShift or not (based on *oc login*'s naming convention), and updates the namespace accordingly. For non-OpenShift clusters, it simply updates the namespace field of the current context. For OpenShift clusters, it either finds an existing context with the namespace, or creates a new one. In either case, it makes sure that the user can access the namespace before making any changes.

```
./kube-ahoy.py -n my-awesome-namespace
```

I recall other cluster CLI's having similar approaches to OpenShift's. If they're identifieable by their context naming convention, then this feature can be easily extended to include them.

### Interactive login
One thing I like about OpenShift is how *oc login* prompts you for credentials and then updates your kubeconfig for you. I thought it might be cool to have something similar for other Kubernetes clusters. kube-ahoy provides a login feature, which includes some safeguards over raw kubectl to help prevent accidentally breaking exsiting objects in your kubeconfig.  It also tests the login info you provide, before making any changes to your kubeconfig.

```
./kube-ahoy.py --login
```

Caveats
- Does not include an option for client cert auth. 
  - In my experience, client cert auth has always been auto-generated by a cluster CLI or UI, so I didn't think it was a good fit for an interactive login 
  - I might add an option in the future for selectively importing a context from another kubeconfig file. I think this would address most (all?) client cert auth scenarios.
- This doesn't replace *oc login* for your OpenShift clusters. *oc login* converts your OpenShift username/password into a limited-duration token on the fly, and it enforces its naming convention for new objects.

## Design Considerations
I'll probably end up using this script on multiple systems.  In order to make it easier to manage/distribute, I really wanted it to be self-contained within a single file.  To that end, the following standard libraries and command line tools were used instead of libraries that required a pip install:

- 'json' library instead of the PyYAML library
- input() function instead of the 'readchar' library
- curl command instead of the 'requests' library
- kubectl command instead of the 'kubernetes' library

## Why "kube-ahoy"?
Given Kubernetes' nautical theme, "ahoy!" is the only sensible greeting when boarding a ship... err... Kubernetes cluster.  Also, "kube-ahoy" kinda reminds me of that cereal, Chips Ahoy! which is all about having cookies for breakfast. And that makes the pirate in me smile.